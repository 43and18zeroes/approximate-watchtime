<h1>Calculate Your Retention Time</h1>
<h2>Please enter the duration of your content</h2>

<form (ngSubmit)="submit()" #entryForm="ngForm">
  <div class="entry-inputs">
    <mat-form-field>
      <mat-label>Minutes</mat-label>
      <input matInput type="number" name="minutes" [(ngModel)]="minutes" />
    </mat-form-field>
    <mat-form-field>
      <mat-label>Seconds</mat-label>
      <input
        matInput
        type="number"
        name="seconds"
        required
        min="0"
        max="59"
        [(ngModel)]="seconds"
        #secondsField="ngModel"
      />

      @if (secondsField.invalid && secondsField.touched) {
      <mat-error>Please enter a value between 0 and 59.</mat-error>
      }
    </mat-form-field>
  </div>
  <button matButton="tonal" type="submit" [disabled]="!entryForm.valid">
    Submit
  </button>
</form>

@if (submitted) {
  <table mat-table [dataSource]="dataEntryService.timestamps" class="mat-elevation-z2">

    <!-- Spalte: Zeit -->
    <ng-container matColumnDef="time">
      <th class="left-column" mat-header-cell *matHeaderCellDef>Time in Minutes</th>
      <td class="left-column" mat-cell *matCellDef="let ts">
        {{ dataEntryService.formatTimestamp(ts) }}
      </td>
    </ng-container>

    <!-- Spalte: Prozent-Eingabe -->
    <ng-container matColumnDef="percent">
      <th mat-header-cell *matHeaderCellDef>Retention Percentages</th>
      <td class="right-column" mat-cell *matCellDef="let ts; let i = index">
        <mat-form-field class="percent-input-field">
          <mat-label>%</mat-label>
          <input
            matInput
            type="number"
            name="rowInput{{ i }}"
            [(ngModel)]="rowValues[i]"
            required
          />
        </mat-form-field>
      </td>
    </ng-container>

    <!-- Kopf- und Datenzeilen -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
}
